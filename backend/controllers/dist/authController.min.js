"use strict";var bcrypt=require("bcryptjs"),User=require("../models/User");exports.register=function(r,s){var t,n,a,u,o,i;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=r.body,n=t.name,a=t.email,u=t.password,e.next=4,regeneratorRuntime.awrap(User.findOne({email:a}));case 4:if(e.sent)return e.abrupt("return",s.status(400).json({message:"User already exists"}));e.next=7;break;case 7:return e.next=9,regeneratorRuntime.awrap(bcrypt.hash(u,10));case 9:return o=e.sent,i=new User({name:n,email:a,password:o}),e.next=13,regeneratorRuntime.awrap(i.save());case 13:s.status(201).json({message:"User registered successfully!"}),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(0),console.error("Register error:",e.t0),s.status(500).json({message:"Server error during registration"});case 20:case"end":return e.stop()}},null,null,[[0,16]])},exports.login=function(r,s){var t,n,a,u;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=r.body,n=t.email,a=t.password,e.next=4,regeneratorRuntime.awrap(User.findOne({email:n}));case 4:if(u=e.sent){e.next=7;break}return e.abrupt("return",s.status(400).json({message:"User not found"}));case 7:return e.next=9,regeneratorRuntime.awrap(bcrypt.compare(a,u.password));case 9:if(e.sent){e.next=12;break}return e.abrupt("return",s.status(400).json({message:"Invalid password"}));case 12:s.status(200).json({message:"Login successful",user:{name:u.name,email:u.email}}),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),console.error("Login error:",e.t0),s.status(500).json({message:"Server error during login"});case 19:case"end":return e.stop()}},null,null,[[0,15]])};
//# sourceMappingURL=authController.min.js.map
